# 3.4:プログラム構造の問題解決に役立つ設計パターン

こうした設計の方法にはいくつかよく知られたパターンがあります。

高凝集化したり、不正状態から防護したりなどです。


こうした、プログラム構造を改善する設計手法は Design Pattern （設計パターン、デザインパターン）と呼ばれ、、設計ノウハウとして広くカタログ化されています。

`表3.2:設計パターンの例`

|設計パターン|効果|
|:--|:--|
|完全コンストラクタ|不正状態から防護する|
|値オブジェクト|特定の値に関するロジックを高凝集にする|
|ストラテジ|条件分岐を削減し、ロジックを単純化する|
|ポリシー|条件分岐を単純化したり、カスタマイズできるようにする|
|ファーストクラスコレクション|値オブジェクトの亜種で、コレクションに関するロジックを高凝集にする|
|スプラウトクラス|既存のロジックを変更せずに安全に新機能を追加する|

**※先のMoneyクラスは、完全コンストラクタと値オブジェクトを適用したものです。**

## 3.4.1:完全コンストラクタ

完全コンストラクタは不正状態から防護するための設計パターンです。

引数なしのデフォルトコンストラクタで生成し、あとからインスタンス変数に値を設定する方法では、未初期化のスキが生じることを学習しましたね。生焼けオブジェクトのことです。

そこで、インスタンス変数をすべて初期化できるように引数を持ったコンストラクタを用意します。

そして、コンストラクタ内でガード節を用意するのでした。

さらに、インスタンス変数をfinal修飾子で不変とすることで、生成後に不正状態に陥らないようにしていました。

## 3.4.2:値オブジェクト

値オブジェクト（Value Object）は値をクラス（型）として表現する設計パターンです。

プリミティブ型を利用しないことで、異なる型の値がインスタンス変数に渡ることを防ぐことができます。

`表3.3:値オブジェクトとして設計可能な値、概念の例`

|アプリケーション|値オブジェクトとなる値、概念|
|:--|:--|
|ECサイト|税別金額、税込み金額、商品名、注文数、電話番号、配送元、配送先、割引ポイント、割引料金、配送日時|
|タスク管理ツール|タスクタイトル、タスクの説明、コメント、開始日、期日、優先度、進捗状態、担当者ID、担当者名|
|健康管理アプリ|年齢、性別、身長、体重、BMI、血圧、腹囲、体脂肪量、体脂肪率、基礎代謝量|
|ゲーム|最大ヒットポイント、残りヒットポイント、ヒットポイント回復量、攻撃力、魔法力、消費魔法力、所持金、敵がドロップする金額、アイテムの売値、アイテム名|


値オブジェクトと完全コンストラクタは、得たい効果が近いため、ほぼセットで用いられます。

値オブジェクト + 完全コンストラクタ は**オブジェクト指向設計の最も基本である**といえるでしょう。

[TypeScriptとJavaScriptで考えてみた例](../2024-01-20-Sat/readme.md)